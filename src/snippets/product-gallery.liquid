{% assign photo_main_dimension  = '600x' %}
{% assign image_loading_placeholder = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" %}
{% assign current_variant = product.selected_or_first_available_variant %}
{% for option in product.options %}
  {% if option == "color" or option == "Color" %}
    {% assign option_index = "option" | append: forloop.index %}
  {% endif %}
{% endfor %}
{% comment %} Defaults {% endcomment %}
{% if option_index != blank %}
  {% assign has_color_index = true %}
{% endif %}

<div class="product-gallery">
  <div class="product-gallery swiper-container" data-product-gallery-slideshow>
    <div class="product-gallery__wrapper swiper-wrapper">
      {% for image in product.images %}
      {% assign image_alt_pieces = image.alt | split: '|' %}
        {% if has_color_index %}
          <div class="product-gallery__slide {% if image_alt_pieces[1] == current_variant[option_index] %}swiper-slide{% endif %}" data-slide data-color-identifier="{{image_alt_pieces[1]}}">
        {% else %}
          <div class="product-gallery__slide swiper-slide" data-slide>
        {% endif %}
          <img data-src="{{ image | img_url: photo_main_dimension }}" alt="{{image.alt}}" class="swiper-lazy product-gallery__image">
          <span class="swiper-lazy-preloader"></span>
        </div>
      {% endfor %}
    </div>
    <div class="swiper-pagination product-gallery__pagination"></div>
  </div>
</div>