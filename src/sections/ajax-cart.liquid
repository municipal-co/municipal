<div data-section-id="{{ section.id }}" data-section-type="ajax-cart">
  <div class="ajax-cart-container" data-ajax-cart-container>
      <form action="/cart" method="post" class="ajax-cart-form" novalidate>
        <div class="ajax-cart__header">
          <a href="#" class="ajax-cart__close" data-ajax-cart-close>{% include 'icon-close' %}</a>
          <span class="ajax-cart__title">{{ 'cart.general.title' | t }}</span>
        </div>
        {% if section.settings.free_shipping_threshold > 0 %}
        {% assign shipping_threshold = section.settings.free_shipping_threshold | times: 100 %}
          <div class="ajax-cart__shipping-bar-container"
               data-threshold-container
               data-threshold-value="{{ shipping_threshold }}"
               data-in-progress-message="{{section.settings.shipping_threshold_message }}"
               data-complete-message="{{ section.settings.free_shipping_message}}">
            {% if section.settings.shipping_threshold_message != blank %}
              <div class="ajax-cart__shipping-bar-message" data-threshold-message>
                {% assign threshold_money = shipping_threshold | money %}
                {{ section.settings.shipping_threshold_message | replace: '[value]', threshold_money }}
              </div>
            {% endif %}
            <div class="ajax-cart__shipping-bar">
              <div class="ajax-cart__shipping-bar-inner" data-threshold-bar></div>
            </div>
          </div>
        {% endif %}

        <div class="ajax-cart__gwp">

          <input type="hidden" name="id" value="" data-free-gift-form>

          <ul class="ajax-cart__list ajax-cart__list--highlight">
            <li class="ajax-cart__item">
              <div class="ajax-cart__item-image-wrapper frame frame--1x1">
                <img class="ajax-cart__item-image" src="//cdn.shopify.com/s/files/1/0380/4705/6011/products/municipal-apparel_armband-superblend-ls-t-shirt_ocean-heather-white_MMTEE004_front_6e40f57c-73a0-45a4-a022-ee3fd837f322_200x.png?v=1634057476" alt="" data-object-fit="cover" data-object-position="center">
              </div>
              <div class="ajax-cart__item-info">
                <div class="ajax-cart__item-message">
                  Free gift with $100 purchase
                </div>
                <div class="ajax-cart__title-container">
                  <a href="" class="ajax-cart__item-header">
                    Armband SuperBlend LS T-Shirt
                  </a>
                </div>

                <div class="ajax-cart__item-choices">
                  <div class="item-choices">

                    <div class="item-choice is-active">
                      <label id="choice-color" class="item-choice__label">
                        Color:
                      </label>
                      <div class="item-choice__wrap">
                        <button class="item-choice__button" type="button" aria-haspopup="choice-color" aria-expanded="false" aria-labelledby="choice-color">
                          <span class="item-choice__button-lining">
                            <div class="item-choice__swatch" style="background-image: url(//cdn.shopify.com/s/files/1/0380/4705/6011/files/charcoal-marble_swatch_50x50_crop_center.png?v=1602535000)"></div>
                            <span class="item-choice__button-label">
                              Charcoal Marble
                            </span>
                          </span>
                          <span class="item-choice__button-icon">
                            {% include 'icon-caret-down' %}
                          </span>
                        </button>

                        <ul class="item-choice__dropdown" tabindex="-1" role="listbox" aria-labelledby="choice-size">

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <div class="item-choice__swatch" style="background-image: url(//cdn.shopify.com/s/files/1/0380/4705/6011/files/black-black_swatch_50x50_crop_center.png?v=1594326290)"></div>
                              <span class="item-choice__dropdown-label">
                                Black
                              </span>
                            </div>
                          </li>

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <div class="item-choice__swatch" style="background-image: url(//cdn.shopify.com/s/files/1/0380/4705/6011/files/charcoal-marble_swatch_50x50_crop_center.png?v=1602535000)"></div>
                              <span class="item-choice__dropdown-label">
                                Charcoal Marble
                              </span>
                            </div>
                          </li>

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <div class="item-choice__swatch" style="background-image: url(//cdn.shopify.com/s/files/1/0380/4705/6011/files/crimson_swatch_50x50_crop_center.png?v=1601677033);"></div>
                              <span class="item-choice__dropdown-label">
                                Crimson
                              </span>
                            </div>
                          </li>

                        </ul>
                      </div>
                    </div>

                    <div class="item-choice">
                      <label id="choice-size" class="item-choice__label">
                        Size:
                      </label>
                      <div class="item-choice__wrap">
                        <button class="item-choice__button" type="button" aria-haspopup="listbox" aria-expanded="false" aria-labelledby="choice-size">
                          <span class="item-choice__button-lining">
                            <span class="item-choice__button-label">
                              S
                            </span>
                          </span>
                          <span class="item-choice__button-icon">
                            {% include 'icon-caret-down' %}
                          </span>
                        </button>

                        <ul class="item-choice__dropdown" tabindex="-1" role="listbox" aria-labelledby="choice-size">

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <span class="item-choice__dropdown-label">
                                M
                              </span>
                            </div>
                          </li>

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <span class="item-choice__dropdown-label">
                                L
                              </span>
                            </div>
                          </li>

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <span class="item-choice__dropdown-label">
                                XL
                              </span>
                            </div>
                          </li>

                          <li class="item-choice__dropdown-option" role="option">
                            <div class="iten-choice__dropdown-lining">
                              <span class="item-choice__dropdown-label">
                                2XL
                              </span>
                            </div>
                          </li>

                        </ul>
                      </div>
                    </div>

                  </div>
                </div>

                <div class="ajax-item__footer">
                  <div class="ajax-cart__item-price">
                    <s class="ajax-cart__compare-at-price">
                      $28
                    </s>
                    <span class="ajax-cart__discounted-price ajax-cart__discounted-price--free">
                      Free
                    </span>
                  </div>
                </div>
              </div>
            </li>
          </ul>
        </div>

        <div class="ajax-cart__body" data-ajax-cart-body>
          {% comment %} Filled in via JS {% endcomment %}
        </div>
        {% if section.settings.promo_text != blank %}
          <div class="ajax-cart__promo">
            {{ section.settings.promo_text }}
          </div>
        {% endif %}
        <div class="ajax-cart__footer" data-ajax-cart-footer>
          <div class="ajax-cart__footer-top" data-ajax-cart-footer-top>
            {% comment %} Filled in via JS {% endcomment %}
          </div>
          <div class="ajax-cart__footer-bottom">
            <div class="ajax-cart__footer-row">
              <button type="submit" name="checkout" class="btn btn-block btn-secondary">{{ 'cart.general.checkout' | t }}</button>
            </div>
            <div class="ajax-cart__footer-row text-center">
              <button class="btn btn-link ajax-cart__continue-shopping-btn" data-ajax-cart-close>Continue Shopping</button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

{% capture icon_close %}
  {% include 'icon-close' %}
{% endcapture %}

{% raw %}
  <script type="text/x-handlebars-template" data-ajax-cart-body-template>
    {{#if items}}
      <ul class="ajax-cart__list">
      {{#each items}}
        <li class="ajax-cart__item {{#unless available}}ajax-cart__item--sold-out{{/unless}}" data-key="{{ key }}" data-qty="{{ quantity }}" data-ajax-item>
          <button class="ajax-cart__item-remove" data-ajax-cart-item-remove>
            {% endraw %}
            {% include 'icon-close' %}
            {% raw %}
          </button>
          <div class="ajax-cart__item-image-wrapper frame frame--1x1">
            <img src="{{ image }}" class="ajax-cart__item-image" data-object-fit="cover" data-object-position="center">
          </div>
          <div class="ajax-cart__item-info">
            <div class="ajax-cart__title-container">
                <a href="{{ url }}" class="ajax-cart__item-header">
                  {{ product_title }}
                </a>
            </div>
            <ul class="ajax-cart__item-options">
              {{#unless has_only_default_variant}}
                {{#if variant_options}}
                  {{#each variant_options}}
                    <li>
                      {{ name }}: {{ value }}
                    </li>
                  {{/each}}
                {{else}}
                  {{#if variant_title}}
                    <li>{{ variant_title }}</li>
                  {{/if}}
                {{/if}}
              {{/unless}}
              {{#if available}}
                {{#each discounts}}
                  <li class="ajax-item__discount-message">
                    {{title}}
                  </li>
                {{/each}}
              {{/if}}
              {{#unless available}}
                <li class="ajax-item__sold-out-info-container">
                  <span class="ajax-cart__sold-out-notice">This item is currently sold out.</span>
                </li>
              {{/unless}}
            </ul>
            {{#if available}}
              <div class="ajax-item__footer">
                {{#if discounts}}
                  <div class="ajax-cart__item-price">
                    <s class="ajax-cart__compare-at-price">
                      {{ original_price }}
                    </s>
                    <span class="ajax-cart__discounted-price">
                      {{ price }}
                    </span>
                  </div>
                {{else}}
                  <div class="ajax-cart__item-price">
                    {{ price }}
                  </div>
                {{/if }}
                {{#if available}}
                  <div class="ajax-item__quantity-adjuster" data-quantity-adjuster>
                    <button class="quantity-adjuster__decrement" data-decrement>-</button>
                    <input class="quantity-adjuster__input" type="number" value="{{ quantity }}" min="0" max="{{ variant_quantity_limit }}" />
                    <span class="quantity-adjuster__label">{{ quantity }} </span>
                    <button class="quantity-adjuster__increment" data-increment>+</button>
                  </div>
                {{/if}}
              </div>
            {{/if}}
          </div>
        </li>
      {{/each}}
    </ul>
  {{else}}
    <div class="ajax-cart__empty-message">
      {% endraw %}
      {% if section.settings.empty_text != blank %}
        {{ section.settings.empty_text }}
      {% else %}
        {{ 'cart.general.empty' | t }}
      {% endif %}
      {% raw %}
    </div>
  {{/if}}
  </script>

  <script type="text/x-handlebars-template" data-ajax-cart-footer-top-template>
    <div class="ajax-cart__footer-row">
      <p class="ajax-cart__footer-subtotal text-center u-fw-bold"><span>Subtotal:</span> <span>{{ total_price }}</span></p>
    </div>
  </script>
{% endraw %}


{% schema %}
  {
    "name": "Ajax Cart",
    "settings": [
      {
        "id": "empty_text",
        "type": "richtext",
        "label": "Empty Text",
        "default": "<p>Your bag is empty</p>"
      },
      {
        "id": "promo_text",
        "type": "richtext",
        "label": "Promo Text",
        "default": "<p>Promotional Message Here</p>"
      },
      {
        "type": "range",
        "id": "free_shipping_threshold",
        "label": "Free Shipping Threshold",
        "unit": "$",
        "min": 0,
        "max": 500,
        "step": 10,
        "default": 10,
        "info": "Setting this value to 0 will remove the bar completely"
      },
      {
        "type": "textarea",
        "id": "shipping_threshold_message",
        "label": "Shipping threshold message",
        "default": "You are [value] away from free shipping in the U.S.",
        "info": "Sets the message to be shown when the user hasn't reached the threshold set above, use [value] to set up the location of the threshould amount on the text"
      },
      {
        "type": "textarea",
        "id": "free_shipping_message",
        "label": "Threshold completed message",
        "default": "You have free shipping on your order",
        "info": "Message that is displayed after the threshold is set, if this is not present the threshold message will continue to be shown to the users with a value of $0.00"
      }
    ]
  }
{% endschema %}
